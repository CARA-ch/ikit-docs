
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../ikit-config/">
      
      
        <link rel="next" href="../primarysystems-epr/">
      
      
      <link rel="icon" href="../assets/favicon.ico">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.23">
    
    
      
        <title>IKIT Usecases - IKIT for CARA</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.84d31ad4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="matchbox" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#https-endpoints-without-the-need-to-use-client-certificates-and-proxy-functionality" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="IKIT for CARA" class="md-header__button md-logo" aria-label="IKIT for CARA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            IKIT for CARA
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              IKIT Usecases
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="IKIT for CARA" class="md-nav__button md-logo" aria-label="IKIT for CARA" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    IKIT for CARA
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Primary system integration with CARA
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../ikit-config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IKIT Configuration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    IKIT Usecases
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    IKIT Usecases
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#https-endpoints-without-the-need-to-use-client-certificates-and-proxy-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      http(s) endpoints without the need to use client certificates and proxy functionality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Proxy functionality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-atna-messages" class="md-nav__link">
    <span class="md-ellipsis">
      proxy ATNA messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-idp-assertion-from-ikit" class="md-nav__link">
    <span class="md-ellipsis">
      Use the IdP Assertion from IKIT
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../primarysystems-epr/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EPR Primary System Integration
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../faq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    FAQ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    CARA INT Changelog
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../changelog_ikit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    IKIT Changelog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#https-endpoints-without-the-need-to-use-client-certificates-and-proxy-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      http(s) endpoints without the need to use client certificates and proxy functionality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-functionality" class="md-nav__link">
    <span class="md-ellipsis">
      Proxy functionality
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#proxy-atna-messages" class="md-nav__link">
    <span class="md-ellipsis">
      proxy ATNA messages
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#use-the-idp-assertion-from-ikit" class="md-nav__link">
    <span class="md-ellipsis">
      Use the IdP Assertion from IKIT
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



  <h1>IKIT Usecases</h1>

<p>The IKIT can help you speed up or test the development against the integration system:</p>
<ol>
<li>Use http(s) endpoints without the need to use client certificates</li>
<li>Proxy functionality: See directly what you are sending to the integration system and receiving, including basic
   validation, this is available for SOAP webservices and ATNA Audit Events</li>
<li>Use the IdP Assertion from IKIT that you can get a XUA token from the STS (secure token service) to do document
   queries or publish documents</li>
<li>Use the TCU Assertion from IKIT that you can get a XUA token from the STS (secure token service) to publish a
   document via a technical user</li>
</ol>
<h2 id="https-endpoints-without-the-need-to-use-client-certificates-and-proxy-functionality">http(s) endpoints without the need to use client certificates and proxy functionality</h2>
<p>Adapt your webservice endpoints to the one provided in [eprik-config.md]. This allows you to use http or https endpoints
without the need to use client certificates from the beginning and you can verify the if the different webservices are
working.</p>
<p>To execute the examples you can either use <a href="https://curl.se/">curl</a> or use the provided .http files if you
have <a href="https://code.visualstudio.com/">VSCode</a> with
the <a href="https://marketplace.visualstudio.com/items?itemName=humao.rest-client">REST Client</a> extension installed.</p>
<p><a href="../requests/iti-47-weinmann-eprik.http">Demographics Query for WEINMANN</a>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>curl<span class="w"> </span>--request<span class="w"> </span>POST<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span>--url<span class="w"> </span>https://ikit.cara.ch/dep/proxy/cara/int/UPIProxy/services/PIXPDQV3ManagerService<span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span>--header<span class="w"> </span><span class="s1">&#39;content-type: application/soap+xml;charset=UTF-8&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span>--header<span class="w"> </span><span class="s1">&#39;user-agent: vscode-restclient&#39;</span><span class="w"> </span><span class="se">\</span>
<a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="w">  </span>--data<span class="w"> </span><span class="s1">&#39;&lt;soap:Envelope xmlns:soap=&quot;http://www.w3.org/2003/05/soap-envelope&quot;&gt;&lt;soap:Header&gt;&lt;Action soap:mustUnderstand=&quot;true&quot; xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&gt;urn:hl7-org:v3:PRPA_IN201305UV02&lt;/Action&gt;&lt;MessageID xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&gt;urn:uuid:88c76963-f467-49e2-a2c0-a772a4685ee3&lt;/MessageID&gt;&lt;To xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&gt;https://ikit.cara.ch/dep/proxy/cara/int/UPIProxy/services/PIXPDQV3ManagerService&lt;/To&gt;&lt;ReplyTo xmlns=&quot;http://www.w3.org/2005/08/addressing&quot;&gt;&lt;Address&gt;http://www.w3.org/2005/08/addressing/anonymous&lt;/Address&gt;&lt;/ReplyTo&gt;&lt;/soap:Header&gt;&lt;soap:Body&gt;&lt;PRPA_IN201305UV02 xmlns=&quot;urn:hl7-org:v3&quot; ITSVersion=&quot;XML_1.0&quot;&gt;&lt;id extension=&quot;1659464609650&quot; root=&quot;1.3.6.1.4.1.21367.2017.2.1.104&quot;/&gt;&lt;creationTime value=&quot;20220822083241&quot;/&gt;&lt;interactionId extension=&quot;PRPA_IN201305UV02&quot; root=&quot;2.16.840.1.113883.1.6&quot;/&gt;&lt;processingCode code=&quot;T&quot;/&gt;&lt;processingModeCode code=&quot;T&quot;/&gt;&lt;acceptAckCode code=&quot;AL&quot;/&gt;&lt;receiver typeCode=&quot;RCV&quot;&gt;&lt;device classCode=&quot;DEV&quot; determinerCode=&quot;INSTANCE&quot;&gt;&lt;id root=&quot;2.16.756.5.30.1.177.2.2.1.1.3&quot;/&gt;&lt;/device&gt;&lt;/receiver&gt;&lt;sender typeCode=&quot;SND&quot;&gt;&lt;device classCode=&quot;DEV&quot; determinerCode=&quot;INSTANCE&quot;&gt;&lt;id root=&quot;2.16.756.5.30.1.145.1.1&quot;/&gt;&lt;/device&gt;&lt;/sender&gt;&lt;controlActProcess classCode=&quot;CACT&quot; moodCode=&quot;EVN&quot;&gt;&lt;code code=&quot;PRPA_TE201305UV02&quot; displayName=&quot;2.16.840.1.113883.1.6&quot;/&gt;&lt;queryByParameter&gt;&lt;queryId extension=&quot;1659464609651&quot; root=&quot;1.3.6.1.4.1.21367.2017.2.1.104&quot;/&gt;&lt;statusCode code=&quot;new&quot;/&gt;&lt;responseModalityCode code=&quot;R&quot;/&gt;&lt;responsePriorityCode code=&quot;I&quot;/&gt;&lt;parameterList&gt;&lt;livingSubjectName&gt;&lt;value use=&quot;SRCH&quot;&gt;&lt;family&gt;WEINMANN&lt;/family&gt;&lt;/value&gt;&lt;semanticsText&gt;LivingSubject.name&lt;/semanticsText&gt;&lt;/livingSubjectName&gt;&lt;/parameterList&gt;&lt;/queryByParameter&gt;&lt;/controlActProcess&gt;&lt;/PRPA_IN201305UV02&gt;&lt;/soap:Body&gt;&lt;/soap:Envelope&gt;&#39;</span>
</code></pre></div>
<h2 id="proxy-functionality">Proxy functionality</h2>
<p>You can then search for the request on <a href="https://ikit.cara.ch/dep">ikit</a>, it shows ALL requests/responses
which happened today. You can also adjust the filter criteria. If you click on 'show' you see the details of the
request:</p>
<p><img alt="Image title" src="../img/pdqv3-iti47.png" /></p>
<p>If you click on 'Beautify code' it will pretty print the request / response (do not this for assertions which are signed
when you wan't to reuse them). If you click on the 'Response' tab you get the response message. If an Assertion was
provided you would see it in the 'Auth Assertion tab'. If the request failed internally you will see additional information
in the 'Proxy Erro tab' tab. The status 'Response valid' is the IKIT internal validation of the request, it does not
guarantee that the request is correct and accepted by the CARA integration system. You can activate Validation of the message for a 10 minutes timeslot in the Clients Settings tab. This uses the validators provided by ehealth suisse reference environment, see <a href="https://ehealthsuisse.ihe-europe.net/evs/home.seam">EVSClient</a></p>
<h2 id="proxy-atna-messages">proxy ATNA messages</h2>
<p>IKIT offers an endpoint for unauthenticated transport receiver and sender according
to <a href="https://www.rfc-editor.org/rfc/rfc5425#section-5.3">rfc5425</a>. The protocol requires that message length is sent
first and then the other syslog parameters defined
by <a href="https://profiles.ihe.net/ITI/TF/Volume2/ITI-20.html#3.20.4.1.2">ITI-20</a>,
see <a href="../requests/iti-47-atna-raw.txt">example</a>.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a>2164 &lt;85&gt;1 2023-04-18T09:04:00.603Z matchbox.test - - IHE+RFC-3881 - &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;AuditMessage&gt; ...
</code></pre></div>
<p>TODO: with netcat the above message can be directly sent to ikit:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a>nc<span class="w"> </span>-w1<span class="w"> </span>-v<span class="w"> </span>atna.ikit.cara.ch<span class="w"> </span><span class="m">8080</span><span class="w"> </span>&lt;<span class="w"> </span>./docs/requests/iti-47-atna-raw.txt<span class="w"> </span>
</code></pre></div>
<p>and is afterwards visible
in <a href="https://test.ahdis.ch/eprik-cara/index.html#/transaction/02bc28f6-03b6-4d8b-ae7f-34a889267152">eprik-cara atna example</a>,
see tab "headers" for detailed syslog protocol information.</p>
<h2 id="use-the-idp-assertion-from-ikit">Use the IdP Assertion from IKIT</h2>
<p>For document access you need to have an assertion which is based on a IdP token.  IKIT allows you to get the IdP
assertion which you can use for retrieving the SAML2 assertion token if your primary system is not integrated yet with
the IdP.</p>
<p>Authenticate with your Identity Provider. </p>
<p>For web authenticated users you can get the IdP token through: https://test.ahdis.ch/eprik-cara/ and use Login: ... </p>
<p>Note1: This is a temporary workaround until https://ikit.cara.ch/idp/ has integrated support for HIN and TrustID
Note2: If you use https://test.ahdis.ch/eprik-cara with HinId or Trust Id the NameId would be to adapted in emedo currently</p>
<p>If you are authenticated successfully you can add the IdP Token directly to your requests.</p>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>The IdP Token is  valid only for 5 minutes, and you will have to close / reopen the browser, otherwise you will get back the same token which is not valid anymore for the STS</p>
</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
    
  </body>
</html>